name: –£—á–µ–±–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç

on:
  workflow_dispatch:
    inputs:
      action:
        description: '–î–µ–π—Å—Ç–≤–∏–µ'
        required: false
        default: 'schedule'
        type: choice
        options:
          - schedule
          - tasks
          - progress
          - generate_schedule

jobs:
  assistant:
    runs-on: ubuntu-latest
    steps:
      - name: –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        uses: actions/checkout@v4

      - name: –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–µ —Ñ–∞–π–ª—ã
        run: |
          echo '{"–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫":[],"–≤—Ç–æ—Ä–Ω–∏–∫":[],"—Å—Ä–µ–¥–∞":[],"—á–µ—Ç–≤–µ—Ä–≥":[],"–ø—è—Ç–Ω–∏—Ü–∞":[]}' > schedule.json
          echo '{"–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ":["–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á—Ç—É","–°–¥–µ–ª–∞—Ç—å –∑–∞—Ä—è–¥–∫—É"],"—É—á–µ–±–Ω—ã–µ":["–°–¥–µ–ª–∞—Ç—å –î–ó","–ü—Ä–æ—á–∏—Ç–∞—Ç—å –∫–æ–Ω—Å–ø–µ–∫—Ç—ã"],"–ª–∏—á–Ω—ã–µ":["–û—Ç–¥–æ—Ö–Ω—É—Ç—å","–ü–æ–≥—É–ª—è—Ç—å"]}' > tasks.json

      - name: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏
        id: get_date
        run: |
          DAYS=("–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫" "–≤—Ç–æ—Ä–Ω–∏–∫" "—Å—Ä–µ–¥–∞" "—á–µ—Ç–≤–µ—Ä–≥" "–ø—è—Ç–Ω–∏—Ü–∞" "—Å—É–±–±–æ—Ç–∞" "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ")
          DAY_NUM=$(date +%u)
          DAY_INDEX=$((DAY_NUM - 1))
          DAY_RU=${DAYS[$DAY_INDEX]}
          echo "day=$DAY_RU" >> $GITHUB_OUTPUT
          echo "date=$(date +'%d.%m.%Y')" >> $GITHUB_OUTPUT
          echo "time=$(date +'%H:%M')" >> $GITHUB_OUTPUT

      - name: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ
        id: determine_action
        run: |
          ACTION="${{ github.event.inputs.action }}"
          if [ -z "$ACTION" ]; then
            ACTION="schedule"
          fi
          echo "action=$ACTION" >> $GITHUB_OUTPUT

      - name: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          message: |
            üéì *–£—á–µ–±–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç*
            
            üìÖ –î–µ–Ω—å: ${{ steps.get_date.outputs.day }}
            üìÜ –î–∞—Ç–∞: ${{ steps.get_date.outputs.date }}
            ‚è∞ –í—Ä–µ–º—è: ${{ steps.get_date.outputs.time }}
            
            ${{ github.event.inputs.action == 'generate_schedule' && 'üé≤ *–ù–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ!*' || '' }}
            ${{ github.event.inputs.action == 'schedule' && 'üìö *–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*' || '' }}
            ${{ github.event.inputs.action == 'tasks' && '‚úÖ *–ó–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è*' || '' }}
            ${{ github.event.inputs.action == 'progress' && 'üìä *–û—Ç—á–µ—Ç –∑–∞ –Ω–µ–¥–µ–ª—é*' || '' }}
            
            ${{ github.event.inputs.action == 'schedule' && '\nüìã –°–µ–≥–æ–¥–Ω—è –ø–∞—Ä –Ω–µ—Ç. –ú–æ–∂–Ω–æ –∑–∞–Ω—è—Ç—å—Å—è —Å–∞–º–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º!' || '' }}
            
            ${{ github.event.inputs.action == 'tasks' && '\nüìù *–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–∞–¥–∞—á–∏:*' || '' }}
            ${{ github.event.inputs.action == 'tasks' && '\n‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á—Ç—É' || '' }}
            ${{ github.event.inputs.action == 'tasks' && '\n‚Ä¢ –°–¥–µ–ª–∞—Ç—å –ø–ª–∞–Ω –Ω–∞ –¥–µ–Ω—å' || '' }}
            ${{ github.event.inputs.action == 'tasks' && '\n‚Ä¢ –ü–æ—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º' || '' }}
            ${{ github.event.inputs.action == 'tasks' && '\n‚Ä¢ –û—Ç–¥–æ—Ö–Ω—É—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è' || '' }}
            
            ${{ github.event.inputs.action == 'progress' && '\nüìà *–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:*' || '' }}
            ${{ github.event.inputs.action == 'progress' && '\n‚è∞ –ß–∞—Å–æ–≤ —É—á–µ–±—ã: 25' || '' }}
            ${{ github.event.inputs.action == 'progress' && '\n‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á: 18' || '' }}
            ${{ github.event.inputs.action == 'progress' && '\nüìä –ü—Ä–æ–≥—Ä–µ—Å—Å: 85%' || '' }}
            ${{ github.event.inputs.action == 'progress' && '\n\nüèÜ –ú–æ–ª–æ–¥–µ—Ü! –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!' || '' }}
            
            ${{ github.event.inputs.action == 'generate_schedule' && '\nüìÖ –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –Ω–µ–¥–µ–ª—é!' || '' }}
            
            ---
            ü§ñ –ë–æ—Ç —É—Å–ø–µ—à–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç!
          parse_mode: markdown